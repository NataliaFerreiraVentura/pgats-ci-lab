name: 'Execu√ß√£o manual'

on:
  workflow_dispatch:

jobs:
  e2e-tests:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with:
          node-version: latest  

      - name: 'Instala√ß√£o do Yarn'
        run: npm install -g yarn  

      - name: 'Instala√ß√£o das depend√™ncias'
        run: yarn  

      - name: 'Instala√ß√£o do Playwright'
        run: yarn playwright install  

      - name: 'Executando testes E2E com Playwright'
        run: yarn run e2e

      # Notifica√ß√£o de sucesso
      - name: Notificar Discord (sucesso)
        if: success()
        uses: appleboy/discord-action@v1.2.0
        with:
          webhook_url: ${{ secrets.DISCORD_WEBHOOK_URL }}
          message: |
            ‚úÖ *CI passou!*  
            Projeto: **${{ github.repository }}**  
            Branch: `${{ github.ref_name }}`  
            üìÑ [Ver detalhes](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})

      # Notifica√ß√£o de falha
      - name: Notificar Discord (falha)
        if: failure()
        uses: appleboy/discord-action@v1.2.0
        with:
          webhook_url: ${{ secrets.DISCORD_WEBHOOK_URL }}
          message: |
            ‚ùå *CI falhou!*  
            Projeto: **${{ github.repository }}**  
            Branch: `${{ github.ref_name }}`  
            üìÑ [Ver detalhes](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})
